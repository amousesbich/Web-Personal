<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vvip Cheat by will</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* CSS yang sudah ada... */
        
        /* Tambahan style untuk status online/offline */
        .online-status {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .online {
            background-color: #4caf50;
            box-shadow: 0 0 5px #4caf50;
        }
        
        .offline {
            background-color: #f44336;
        }
        
        .user-status-container {
            display: flex;
            align-items: center;
        }
        
        /* Style tambahan untuk tabel admin */
        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .admin-table th, .admin-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        .admin-table th {
            background: var(--primary-blue);
            color: white;
            font-weight: 500;
        }
        
        .admin-table tr:hover {
            background: #f5f9ff;
        }
        
        .action-btn {
            padding: 8px 12px;
            background: var(--primary-blue);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 5px;
            font-size: 12px;
        }
        
        .action-btn.delete {
            background: #f44336;
        }
    </style>
</head>
<body>
    <!-- HTML yang sudah ada... -->

    <script>
        // Data pengguna
        const predefinedTokens = [
            "tk_admin_12345", // Token admin dengan masa aktif 99999 hari
            "tk_admin_will55", // Token admin baru untuk will55
            "tk_5x8q3m2z1r",
            "tk_9a2b4c6d8e",
            // ... token lainnya
        ];

        let users = JSON.parse(localStorage.getItem('gameAppUsers')) || [];
        let currentUser = null;
        let onlineUsers = JSON.parse(localStorage.getItem('onlineUsers')) || {};

        // Inisialisasi admin user jika belum ada
        function initAdminUser() {
            const adminExists = users.some(user => user.username === 'admin');
            const will55Exists = users.some(user => user.username === 'will55');
            
            if (!adminExists) {
                users.push({
                    username: 'admin',
                    password: 'admin123',
                    token: 'tk_admin_12345',
                    expiryDays: 99999,
                    regDate: new Date().toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }),
                    lastLogin: new Date().toISOString()
                });
            }
            
            if (!will55Exists) {
                users.push({
                    username: 'will55',
                    password: 'will55',
                    token: 'tk_admin_will55',
                    expiryDays: 99999,
                    regDate: new Date().toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }),
                    lastLogin: new Date().toISOString()
                });
            }
            
            localStorage.setItem('gameAppUsers', JSON.stringify(users));
        }

        // Fungsi untuk login
        function login() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            const user = users.find(u => u.username === username && u.password === password);

            if (user) {
                currentUser = user;
                
                // Update status online
                onlineUsers[user.username] = {
                    online: true,
                    lastSeen: new Date().toISOString()
                };
                localStorage.setItem('onlineUsers', JSON.stringify(onlineUsers));
                
                // Update last login
                user.lastLogin = new Date().toISOString();
                const userIndex = users.findIndex(u => u.username === user.username);
                if (userIndex !== -1) {
                    users[userIndex] = user;
                    localStorage.setItem('gameAppUsers', JSON.stringify(users));
                }

                document.getElementById('authContainer').style.display = 'none';
                document.querySelector('.main-content').style.display = 'block';
                document.getElementById('sidebar').style.display = 'flex';
                updateUI();

                // Tampilkan menu admin jika user adalah admin
                if (currentUser.token === 'tk_admin_12345' || currentUser.token === 'tk_admin_will55') {
                    document.querySelectorAll('.admin-only').forEach(el => {
                        el.style.display = 'block';
                    });
                }

                // Create floating particles
                createParticles();
            } else {
                alert('Username atau password salah!');
            }
        }

        // Fungsi untuk logout
        function logout() {
            if (currentUser) {
                // Update status offline
                onlineUsers[currentUser.username] = {
                    online: false,
                    lastSeen: new Date().toISOString()
                };
                localStorage.setItem('onlineUsers', JSON.stringify(onlineUsers));
            }
            
            currentUser = null;
            document.getElementById('authContainer').style.display = 'flex';
            document.querySelector('.main-content').style.display = 'none';
            document.getElementById('sidebar').style.display = 'none';
            document.getElementById('loginUsername').value = '';
            document.getElementById('loginPassword').value = '';

            // Sembunyikan menu admin
            document.querySelectorAll('.admin-only').forEach(el => {
                el.style.display = 'none';
            });

            // Remove particles
            const particles = document.getElementById('particles');
            particles.innerHTML = '';
        }

        // Fungsi untuk memperbarui UI berdasarkan user yang login
        function updateUI() {
            if (!currentUser) return;

            document.getElementById('userAvatar').textContent = currentUser.username.charAt(0).toUpperCase();
            document.getElementById('userName').textContent = currentUser.username;
            
            // Update status online/offline
            const isOnline = onlineUsers[currentUser.username] && onlineUsers[currentUser.username].online;
            document.getElementById('userStatus').innerHTML = `
                <span class="online-status ${isOnline ? 'online' : 'offline'}"></span>
                Status: ${isOnline ? 'Online' : 'Offline'}
            `;

            document.getElementById('profileUsername').textContent = currentUser.username;
            document.getElementById('profileToken').textContent = currentUser.token;
            document.getElementById('profileExpiry').textContent = `${currentUser.expiryDays} Hari`;
            document.getElementById('profileStatus').textContent = currentUser.expiryDays > 0 ? 'Aktif' : 'Tidak Aktif';
            document.getElementById('profileRegDate').textContent = currentUser.regDate;

            document.getElementById('settingsUsername').value = currentUser.username;
            document.getElementById('settingsToken').value = currentUser.token;

            document.getElementById('remainingDays').textContent = `${currentUser.expiryDays} Hari`;

            // Update daftar user jika admin
            if (currentUser.token === 'tk_admin_12345' || currentUser.token === 'tk_admin_will55') {
                updateUserList();
            }
        }
        
        // Fungsi untuk mengupdate daftar user di admin panel
        function updateUserList() {
            const userList = document.getElementById('userList');
            userList.innerHTML = '';
            
            users.forEach(user => {
                const isOnline = onlineUsers[user.username] && onlineUsers[user.username].online;
                const lastSeen = onlineUsers[user.username] ? new Date(onlineUsers[user.username].lastSeen).toLocaleString('id-ID') : 'Tidak diketahui';
                
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${user.username}</td>
                    <td>${user.token}</td>
                    <td>${user.expiryDays} Hari</td>
                    <td>
                        <span class="online-status ${isOnline ? 'online' : 'offline'}"></span>
                        ${isOnline ? 'Online' : 'Offline'}
                    </td>
                    <td>${lastSeen}</td>
                    <td>${user.regDate}</td>
                    <td>
                        <button class="action-btn" onclick="adminEditUser('${user.token}')">Edit</button>
                        ${user.token !== 'tk_admin_12345' && user.token !== 'tk_admin_will55' ? 
                          `<button class="action-btn delete" onclick="adminDeleteUser('${user.token}')">Hapus</button>` : 
                          ''}
                    </td>
                `;
                
                userList.appendChild(row);
            });
        }

        // Fungsi untuk admin menghapus user
        function adminDeleteUser(token) {
            if (token === 'tk_admin_12345' || token === 'tk_admin_will55') {
                alert('Tidak dapat menghapus akun admin!');
                return;
            }
            
            if (confirm('Apakah Anda yakin ingin menghapus user ini?')) {
                // Hapus dari online users juga
                const userToDelete = users.find(u => u.token === token);
                if (userToDelete && onlineUsers[userToDelete.username]) {
                    delete onlineUsers[userToDelete.username];
                    localStorage.setItem('onlineUsers', JSON.stringify(onlineUsers));
                }
                
                users = users.filter(u => u.token !== token);
                localStorage.setItem('gameAppUsers', JSON.stringify(users));
                alert('User berhasil dihapus!');
                updateUserList();
            }
        }

        // Inisialisasi saat halaman dimuat
        document.addEventListener('DOMContentLoaded', function() {
            initAdminUser();
            onlineUsers = JSON.parse(localStorage.getItem('onlineUsers')) || {};

            // ... kode lainnya yang sudah ada
        });

        // Fungsi untuk mengecek status online secara berkala
        setInterval(() => {
            if (currentUser) {
                onlineUsers[currentUser.username] = {
                    online: true,
                    lastSeen: new Date().toISOString()
                };
                localStorage.setItem('onlineUsers', JSON.stringify(onlineUsers));
                
                // Update UI jika di panel admin
                if (document.getElementById('admin').classList.contains('active')) {
                    updateUserList();
                }
            }
        }, 30000); // Update setiap 30 detik
    </script>
</body>
</html>